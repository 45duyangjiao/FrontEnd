<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<title>公告列表</title>
		<link href="../css/common.css" rel="stylesheet" />
		<link href="../css/announce.css" rel="stylesheet" />
		<link href="../css/mui.min.css" rel="stylesheet" />
		<script src="../js/jquery-1.9.1.min.js"></script>
		<script src="../js/flexable.js"></script>
	</head>

	<body>
		<div class="mui-content">
			<div id="slider" class="mui-slider mui-fullscreen">
				<div id="sliderSegmentedControl" class="mui-scroll-wrapper mui-slider-indicator mui-segmented-control mui-segmented-control-inverted">
					<div class="mui-scroll" id="cur">
						<!--<a class="mui-control-item mui-active" href="#item1mobile">政策法规</a>
						<a class="mui-control-item" href="#item2mobile">会议</a>
						<a class="mui-control-item" href="#item3mobile">通知</a>
						<a class="mui-control-item" href="#item4mobile">声明</a>
						<a class="mui-control-item" href="#item5mobile">其他</a>-->
					</div>
				</div>
				<div class="mui-slider-group">
					<div id="item1mobile" class="mui-slider-item mui-control-content mui-active">
						<div id="scroll1" class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<div id="view"></div>
								<ul class="mui-table-view announceUl" id="List">
									<!--<li class="mui-table-view-cell announceLi">
										<div class="floatL announceNewsImg"><img src="../img/timg4.jpg"/></div>
										<div class="announceNews clearfix floatR">
											<div class="announceNewsTil">2017年全国大众跆拳道一级以上 裁判员年审复培训训班</div>
											<div class="announceNewsTime floatR">2017-03-04</div>
										</div>
									</li>-->
								</ul>
							</div>
						</div>
					</div>

				</div>
			</div>
		</div>

		<script>
			function texts(id) {
				window.location.href = "announceContent.html?id=" + id;
			}

			var NavUrl = "http://47.93.192.128:5001/Notice/NoticeNavBar";
			var ListUrl = "http://47.93.192.128:5001/Notice/Notice_List";

			//加载列表的方法
			function innerList(typeid) {

				$.ajax({
					type: "post",
					url: ListUrl,
					data: {
						type_id: typeid,
						pageindex: 1
					},
					datatype: "json",
					success: function(data) {
						//						console.log(data)
						data = eval('(' + data + ')');
						var fragment = document.createDocumentFragment(); //创建一个代码片段
						var li;
						if(typeof(data.Data.Data) != "undefined") {
							for(var i = 0; i < data.Data.Data.length; i++) { //循环输出data中的数据
								//								console.log(data.Data.Data[i].Id)
								li = document.createElement('li');
								li.className = 'mui-table-view-cell announceLi';
								li.innerHTML = '<div class="floatL announceNewsImg"><img src="' +
									data.Data.Data[i].pic +
									'"/></div><div class="announceNews clearfix floatR"><div onclick="texts(' + data.Data.Data[i].Id + ')" class="announceNewsTil">' +
									data.Data.Data[i].Title +
									'</div><div class="announceNewsTime floatR">' +
									data.Data.Data[i].CreatedTime +
									'</div></div>'
								fragment.appendChild(li);
							}

						}

						$('#List li').remove();
						document.querySelector("#List").appendChild(fragment); //输出到#item1mobile的页面内容

					},
					error: function() {

					}
				});
			}
			//加载导航的方法
			function innerNav() {

				$.ajax({
					type: "post",
					url: NavUrl,
					datatype: "json",
					success: function(data) {
						data = eval('(' + data + ')');
						var fragment = document.createDocumentFragment(); //创建一个代码片段
						var a;
						if(typeof(data.Data.Data) != "undefined") { //这里是判断是不是有数据的 如果没数据直接不用循环 否则 undefined len属性
							for(var i = data.Data.Data.length - 1; i >= 0; i--) { //循环输出data中的数据
								a = document.createElement('a');
								a.className = 'mui-control-item';
								a.href = "javascript:innerList(" + data.Data.Data[i].Id + ");";
								a.innerHTML = data.Data.Data[i].Title;
								fragment.appendChild(a);
							}
						}

						document.querySelector("#cur").appendChild(fragment); //输出到#item1mobile的页面内容
						$("#cur>a:first-child").addClass("mui-active")
						$("#cur>a").bind("click", function() {
							$("#cur>a").removeClass("mui-active");
							$(this).addClass("mui-active")
						})
						//innerList(parseInt(data.Data.Data[0].Id));

					},
					error: function() {

					}
				});
			}

			//页面价在后执行   加载导航的方法
			window.onload = function() {
				getRem(750, 100)
				innerNav(11);

			}
			window.onresize = function() {
				getRem(750, 100)
			};

			function getRem(pwidth, prem) {
				var html = document.getElementsByTagName("html")[0];

				var oWidth = document.body.clientWidth || document.documentElement.clientWidth;
				html.style.fontSize = oWidth / pwidth * prem + "px";
			}
		</script>

	</body>

</html>