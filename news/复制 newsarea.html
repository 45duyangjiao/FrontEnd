<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>新闻频道</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link href="../css/common.css" rel="stylesheet" />
		<link href="../css/newsArea.css" rel="stylesheet" />
		<link href="../css/mui.min.css" rel="stylesheet" />
	</head>
	<body>
		<div class="mui-scroll-wrapper" id="protocol">
			<div class="mui-scroll">
				<div class="newsAera">
					<div class="myChannel">
						<div class="myChannelTil clearfix">
							<span class="floatL">我的频道</span>
							<span class="floatR">编辑</span>
						</div>
						<ul class="myChannelmodule clearfix"></ul>
					</div>
					<div class="compileChannel">
						<div class="myChannelTil clearfix">
							<span class="floatL">点击添加更多频道</span>
						</div>
						<div class="dynamicallyAdd"></div>
					</div>
				</div>
			</div>
		</div>
		<script src="../js/flexable.js"></script>
		<script src="../js/zepto_1.1.3.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/mui.min.js"></script>
		<script src="../js/common.js"></script>
		<script src="../js/newsarea.js"></script>
		<script src="../js/artTemplate.js"></script>
		
		<!-- 我的频频道，删除，添加-->
		<script type="text/html" id="myChannel">
			{{each myChannel as value}}
				<li class="floatL channelOriginal zhu" id='{{value.channelid}}'>{{value.title}}
					<sup class="supDelate">x</sup>
				</li>
			{{/each}}
		</script>
		
		<!--循环ul模板嵌套并嵌套li循环-->
		<script type="text/html" id="channel">
			{{each channel as value i}}
				<p class="compileAddChannelTile">{{value.Title}}</p>
				<div class="dynamicallyAdd">
   					<ul class="compileAddChannelArea commonHeight clearfix" id='Ty{{i}}'>
						{{include 'channelSon' value}}
					</ul>
				</div>
			{{/each}}
		</script>
		<!--ul中的li循环-->
		<script type="text/html" id="channelSon">
			{{each Son as value i}}
				<li class="floatL channelOriginal pu" id='{{value.Id}}'>{{value.Title}}
					<!--<sup class="supDelate">x</sup>-->
				</li>
			{{/each}}
		</script>
		
		<script>

			$('.floatR').click(function(){	
				if($(".supDelate").css("display")=="none"){
					$(".supDelate").show();
					$('.floatR').html("完成");
				}else{
					$(".supDelate").hide();
					$('.floatR').html("编辑")
				}
				
			})

			$(document).ready(function() {
				var url = 'http://47.93.192.128:5001/News/GetMoreNewsType';
				$.ajax({
					url: url,
					dataType: 'json',
					type: 'post',
					success: function(data) {
						console.log(data)
						var str = template("channel", {channel: data.Data.Data});	
						$(".dynamicallyAdd").html(str);

						$(".compileChannel .pu").bind("click",function(e){
							$(e.target).removeClass('pu').addClass('zhu')
							e.target.remove()
							$('.myChannelmodule').append(e.target)
							var  channelId=$(e.target).attr("id");
							console.log(channelId);
							
							$.ajax({
								type:"post",
								url:"http://47.93.192.128:5001/News/AddMyChannel",
								async:true,
								dataType: 'json',
								data:{
									userId:10002,
									channelId:channelId
								},
								success:function(data){
									alert("添加 成功")
								}
								
							});
						})
						
						$(".myChannelmodule .zhu").bind("click",function(e){
							console.log(11)
//							e.target.remove()
//							alert(e.target.id)
//							if(e.target.id<10)
//							$('#Ty0').append(e.target)
//							else if(e.target < 30)
//							$('#Ty1').append(e.target)
//							else if(e.target > 30)
//							$('#Ty2').append(e.target)
						})
									
					},
					error: function(XMLHttpRequest, textStatus, errorThrown) {
						alert(XMLHttpRequest.status);

					}
				});
			});

			　　
				
			
		
		
		</script>
		
		
		
		
	</body>

</html>